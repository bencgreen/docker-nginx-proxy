#!/usr/bin/with-contenv bash

#======================================================================================================================
# Check whether or not domains have been registered
#======================================================================================================================

if [ "${#DOMAINS[@]}" = "0" ] ; then
    echo " - no domains have been registered for SSL."
    exit 1
fi


#======================================================================================================================
# Check directory structure
#======================================================================================================================

[[ ! -d /ssl/certs ]] && mkdir /ssl/certs
[[ ! -d /ssl/conf ]] && mkdir /ssl/conf


#======================================================================================================================
# Setup each primary domain
#======================================================================================================================

echo " - creating configuration..."
for D in "${!DOMAINS[@]}" ; do
    echo " - domain ${D}..."
    touch /sites/${D}
    getssl -w /ssl/certs -d -c ${D}
done
echo " - done."

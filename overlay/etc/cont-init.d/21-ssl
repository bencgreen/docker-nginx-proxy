#!/usr/bin/with-contenv bash

set -euo pipefail


#======================================================================================================================
# Check for clean install
#======================================================================================================================

if [ "${CLEAN_INSTALL}" = "1" ] ; then

    _echo "Clean install detected, cleaning ${SSL_CERTS} and ${SITES}..."

    [[ -z "${SSL_GLOBAL_CFG}" ]] && _error "SSL_GLOBAL_CFG not defined."
    rm -rf ${SSL_GLOBAL_CFG}

    [[ -z "${SSL_CERTS}" ]] && _error "SSL_CERTS not defined."
    rm -rf ${SSL_CERTS}/*

    [[ -z "${SITES}" ]] && _error "SITES not defined."
    rm -rf ${SITES}/*

    _done

fi


#======================================================================================================================
# Run initialisation script
#======================================================================================================================

ssl-init
